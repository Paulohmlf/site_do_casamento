<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lista de Presentes - Paulo & LÃªdja</title>
  
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/presentes.css">

  <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://*.supabase.co https://api.qrserver.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; script-src 'self' https://cdn.jsdelivr.net 'unsafe-inline'">

  <script src="js/auth.js"></script>
</head>
<body>
  <section class="presentes-section">
    <div class="container">
      <h1>Lista de Presentes</h1>
      <p class="subtitulo">Escolha um presente e reserve para nÃ³s!</p>

      <div class="filtros">
        <input type="text" id="busca" placeholder="ğŸ” Buscar presente...">
        <select id="filtro-categoria">
          <option value="">Todas as categorias</option>
          <option value="Cozinha">Cozinha</option>
          <option value="Banheiro">Banheiro</option>
          <option value="Lavanderia">Lavanderia</option>
          <option value="Quarto">Quarto</option>
          <option value="EletrodomÃ©sticos">EletrodomÃ©sticos</option>
        </select>
      </div>

      <div id="grid-presentes" class="presentes-grid">
        <p class="loading">Carregando presentes...</p>
      </div>

      <a href="index.html" class="btn btn-secondary" style="margin-top: 30px;">Voltar para InÃ­cio</a>
    </div>
  </section>

  <div id="modal-reserva" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="close">&times;</span>
      
      <div id="fase-confirmacao">
        <h2>Confirmar Reserva</h2>
        <div style="text-align: center; margin: 20px 0;">
          <p>VocÃª deseja reservar o item:</p>
          <h3 id="presente-nome" style="color: #1a2332; margin: 10px 0;"></h3>
          <p style="font-size: 1.1rem; color: #d4af37; font-weight: bold;" id="presente-valor-texto"></p>
          
          <p style="font-size: 0.9rem; color: #666; margin-top: 15px;">
            A reserva serÃ¡ registrada em nome de: <br>
            <strong id="nome-comprador-modal" style="color: #1a2332; font-size: 1.1rem;"></strong>
          </p>
        </div>

        <form id="form-reserva">
          <input type="hidden" id="presente-id">
          <button type="submit" class="btn btn-primary" style="width: 100%;">Confirmar e Ver PIX ğŸ</button>
        </form>
      </div>

      <div id="fase-pix" style="display: none; text-align: center;">
        <h2 style="color: #4caf50;">Reserva Realizada! ğŸ‰</h2>
        <p style="font-size: 0.9rem; color: #666;">Para concluir, pague via PIX:</p>
        
        <div style="margin: 15px auto; width: 180px; height: 180px; background: #f0f0f0; padding: 10px; border-radius: 8px;">
          <img id="img-qrcode" src="" alt="QR Code PIX" style="width: 100%; height: 100%;">
        </div>

        <div style="margin-bottom: 20px;">
          <textarea id="texto-pix" rows="3" style="width: 100%; font-size: 0.8rem; padding: 10px; border: 1px solid #ddd; border-radius: 5px; background: #f9f9f9;" readonly></textarea>
          
          <div style="display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap;">
            <button id="btn-copiar" type="button" class="btn btn-secondary" onclick="copiarPix()" style="flex: 1; min-width: 120px;">
              ğŸ“‘ Copiar CÃ³digo
            </button>
            <a id="btn-ir-banco" href="#" target="_blank" class="btn btn-primary" style="flex: 1; min-width: 120px; display: flex; align-items: center; justify-content: center; text-decoration: none;">
              ğŸ“± Abrir App do Banco
            </a>
          </div>
        </div>

        <button type="button" class="btn" onclick="enviarComprovante()" 
                style="width: 100%; background: #25D366; color: white; border: none; font-weight: bold; padding: 12px; border-radius: 8px; display: flex; align-items: center; justify-content: center; gap: 10px;">
           Enviar Comprovante (WhatsApp) ğŸŸ¢
        </button>
      </div>

    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="js/config.js"></script>
  <script src="js/main.js"></script>
  <script src="js/presentes.js"></script>
</body>
</html>